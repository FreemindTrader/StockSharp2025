<l1lil:ChartPanel xmlns:l1lil="clr-namespace:StockSharp.Xaml.Charting"
                  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                  xmlns:dxb="clr-namespace:DevExpress.Xpf.Bars;assembly=DevExpress.Xpf.Core.v22.1"
                  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                  xmlns:loc="clr-namespace:StockSharp.Xaml;assembly=StockSharp.Xaml"
                  xmlns:ll1="clr-namespace:Ecng.Xaml.Converters;assembly=StockSharp.Xaml"
                  xmlns:s="clr-namespace:-"
                  xmlns:dxe="clr-namespace:DevExpress.Xpf.Editors.Settings;assembly=DevExpress.Xpf.Core.v22.1"
                  xmlns:lll="clr-namespace:Ecng.Xaml;assembly=StockSharp.Xaml"
                  xmlns:dx="clr-namespace:DevExpress.Xpf.Core;assembly=DevExpress.Xpf.Core.v22.1"
                  xmlns:li1111lil="clr-namespace:DevExpress.Xpf.Core.Native;assembly=DevExpress.Xpf.Core.v22.1"
                  xmlns:l11="clr-namespace:DevExpress.Xpf.Bars.Themes;assembly=DevExpress.Xpf.Core.v22.1"
                  xmlns:l1i="clr-namespace:DevExpress.Xpf.Utils.Themes;assembly=DevExpress.Xpf.Core.v22.1"
                  x:Name="Ctrl" dxb:BarNameScope.IsScopeOwner="True">
  <UIElement.CommandBindings>
    <CommandBinding Command="{x:Static l1lil:ChartPanel.RegisterOrderCommand}"/>
    <CommandBinding Command="{x:Static l1lil:ChartPanel.ShareCommand}"/>
    <CommandBinding Command="{x:Static loc:RoutedCommands.CancelOrders}"/>
    <CommandBinding Command="{x:Static l1lil:ChartPanel.PatternCommand}"/>
  </UIElement.CommandBindings>
  <FrameworkElement.Resources>
    <Style x:Key="ImgStyle" TargetType="{x:Type Image}">
      <Style.Triggers>
        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, AncestorLevel=1}, Path=IsEnabled}"
                     Value="False">
          <Setter Property="UIElement.Opacity" Value="0.3"/>
        </DataTrigger>
      </Style.Triggers>
    </Style>
    <ll1:EnumBooleanConverter x:Key="EnumBooleanConverter" DefaultValueWhenUnchecked="True"/>
    <ll1:VisibilityToBoolConverter x:Key="VisToBool"/>
    <l1lil:ChartTimeFrameNameConverter x:Key="TimeFrame2Name"/>
  </FrameworkElement.Resources>
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition/>
    </Grid.RowDefinitions>
    <loc:QuickOrderPanel x:Name="QuickOrderPanel" Grid.Row="1" Width="400" Height="45" Visibility="Collapsed"
                                Panel.ZIndex="100" HorizontalAlignment="Left" VerticalAlignment="Top"/>
    <dxb:BarManager x:Name="BarManager" Grid.Row="0">
      <dxb:BarManager.Bars>
        <dxb:Bar>
          <dxb:BarSplitButtonItem ActAsDropDown="True" ToolTipService.ShowOnDisabled="True"
                                    ToolTip="{loc:Localization AddPanel}" IsEnabled="{Binding IsInteracted, ElementName=Chart}"
                                    Glyph="{loc:ThemedIcons Key=Add}">
            <dxb:BarSplitButtonItem.PopupControl>
              <s:dje_zHRCSWK4ZNLJHREKZYGF3XQ6G3FQDVTLXGBGA7V24_ejd DataContext="{Binding DataContext, ElementName=Chart}"/>
            </dxb:BarSplitButtonItem.PopupControl>
          </dxb:BarSplitButtonItem>
          <dxb:BarEditItem x:Name="CandleStyles" EditWidth="120">
            <dxb:BarEditItem.EditSettings>
              <dxe:ComboBoxEditSettings x:Name="CandleStylesSettings" IsTextEditable="False" ApplyItemTemplateToSelectedItem="True">
                <dxe:LookUpEditSettingsBase.ItemTemplate>
                  <DataTemplate>
                    <Border Background="Transparent">
                      <StackPanel Orientation="Horizontal">
                        <Image Width="16" Height="16" Source="{lll:ThemedIconBinding Path=Image}"/>
                        <TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="{Binding Path=Name}"/>
                      </StackPanel>
                    </Border>
                  </DataTemplate>
                </dxe:LookUpEditSettingsBase.ItemTemplate>
              </dxe:ComboBoxEditSettings>
            </dxb:BarEditItem.EditSettings>
          </dxb:BarEditItem>
          <dxb:BarEditItem x:Name="TfSelector" EditWidth="65" IsEnabled="{Binding IsInteracted, ElementName=Chart}">
            <dxb:BarEditItem.EditSettings>
              <dxe:ComboBoxEditSettings x:Name="_tfSelectorCb" IsTextEditable="False" ApplyItemTemplateToSelectedItem="True">
                <dxe:LookUpEditSettingsBase.ItemTemplate>
                  <DataTemplate>
                    <Border Background="Transparent" Margin="5,0">
                      <TextBlock VerticalAlignment="Center" Text="{Binding Path=., Converter={StaticResource TimeFrame2Name}}"/>
                    </Border>
                  </DataTemplate>
                </dxe:LookUpEditSettingsBase.ItemTemplate>
              </dxe:ComboBoxEditSettings>
            </dxb:BarEditItem.EditSettings>
          </dxb:BarEditItem>
          <dxb:BarItemSeparator/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization AutoScroll}"
                              ToolTip="{loc:Localization AutoScroll}"
                              IsChecked="{Binding ElementName=Chart, Path=IsAutoScroll}"
                              Glyph="{loc:ThemedIcons Key=Scroll}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization AutoScaling}"
                              ToolTip="{loc:Localization AutoScaling}"
                              IsChecked="{Binding ElementName=Chart, Path=AutoRangeByAnnotations}"
                              Glyph="{loc:ThemedIcons Key=UpDown}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization Legend}"
                              ToolTip="{loc:Localization Legend}" IsChecked="{Binding ElementName=Chart, Path=ShowLegend}"
                              Glyph="{loc:ThemedIcons Key=List}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization OverviewArea}"
                              ToolTip="{loc:Localization OverviewArea}"
                              IsChecked="{Binding ElementName=Chart, Path=ShowOverview}"
                              Glyph="{loc:ThemedIcons Key=Footer}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization ShowCross}"
                              ToolTip="{loc:Localization ShowCross}"
                              IsChecked="{Binding ElementName=Chart, Path=CrossHair}"
                              Glyph="{loc:ThemedIcons Key=Crosshair}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization ShowTooltip}"
                              ToolTip="{loc:Localization ShowTooltip}"
                              IsChecked="{Binding ElementName=Chart, Path=CrossHairTooltip}"
                              IsEnabled="{Binding ElementName=Chart, Path=CrossHair}"
                              Glyph="{loc:ThemedIcons Key=Tooltip}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization ShowValuesOnAxis}"
                              ToolTip="{loc:Localization ShowValuesOnAxis}"
                              IsChecked="{Binding ElementName=Chart, Path=CrossHairAxisLabels}"
                              IsEnabled="{Binding ElementName=Chart, Path=CrossHair}" Glyph="{loc:ThemedIcons Key=Ruler}"/>
          <dxb:BarButtonItem Command="{x:Static l1lil:ChartPanel.PatternCommand}"
                               ToolTip="{loc:Localization PatternDesc}" Content="{loc:Localization Pattern}"
                               Glyph="{loc:ThemedIcons Key=GanttChart}" CommandTarget="{Binding ElementName=Ctrl}"/>
          <dxb:BarItemSeparator/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization Line2}"
                              ToolTip="{loc:Localization Line2}"
                              IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=LineAnnotation}"
                              Glyph="{loc:ThemedIcons Key=Line}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization Pointer}"
                              ToolTip="{loc:Localization Pointer}"
                              IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=LineArrowAnnotation}"
                              Glyph="{loc:ThemedIcons Key=RightArrowLine}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization VerLine}"
                              ToolTip="{loc:Localization VerLine}"
                              IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=VerticalLineAnnotation}">
            <dxb:BarItem.GlyphTemplate>
              <DataTemplate>
                <Image Source="{loc:ThemedIcons Key=Line}">
                  <UIElement.RenderTransform>
                    <RotateTransform Angle="-45" CenterX="7" CenterY="7"/>
                  </UIElement.RenderTransform>
                </Image>
              </DataTemplate>
            </dxb:BarItem.GlyphTemplate>
          </dxb:BarCheckItem>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization HorLine}"
                              ToolTip="{loc:Localization HorLine}"
                              IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=HorizontalLineAnnotation}">
            <dxb:BarItem.GlyphTemplate>
              <DataTemplate>
                <Image Source="{loc:ThemedIcons Key=Line}">
                  <UIElement.RenderTransform>
                    <RotateTransform Angle="45" CenterX="7" CenterY="7"/>
                  </UIElement.RenderTransform>
                </Image>
              </DataTemplate>
            </dxb:BarItem.GlyphTemplate>
          </dxb:BarCheckItem>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization Area}"
                              ToolTip="{loc:Localization Area}"
                              IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=BoxAnnotation}"
                              Glyph="{loc:ThemedIcons Key=Rectangle}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization Text}"
                              ToolTip="{loc:Localization Text}"
                              IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=TextAnnotation}"
                              Glyph="{loc:ThemedIcons Key=Font}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization Ruler}"
                              ToolTip="{loc:Localization Ruler}"
                              IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=RulerAnnotation}"
                              Glyph="{loc:ThemedIcons Key=Ruler2}"/>
          <dxb:BarCheckItem ToolTipService.ShowOnDisabled="True" Content="{loc:Localization ShowFPS}"
                              ToolTip="{loc:Localization ShowFPS}"
                              IsChecked="{Binding ElementName=Chart, Path=ShowPerfStats}"
                              Glyph="{loc:ThemedIcons Key=Speedometer}"/>
          <dxb:BarItemSeparator/>
          <dxb:BarButtonItem ToolTip="{loc:Localization SaveDataFromChart}"
                               Content="{loc:Localization SaveDataFromChart}" Glyph="{loc:ThemedIcons Key=Save}"/>
          <dxb:BarSplitButtonItem Command="{x:Static l1lil:ChartPanel.ShareCommand}"
                                    ToolTip="{loc:Localization ShareImage}" Content="{loc:Localization ShareImage}"
                                    CommandTarget="{Binding ElementName=Ctrl}" Glyph="{loc:ThemedIcons Key=Share}">
            <dxb:BarSplitButtonItem.PopupControl>
              <dxb:PopupMenu>
                <dxb:PopupMenu.Items>
                  <dxb:BarButtonItem Content="{loc:Localization Settings}" Glyph="{loc:ThemedIcons Key=Settings}"/>
                </dxb:PopupMenu.Items>
              </dxb:PopupMenu>
            </dxb:BarSplitButtonItem.PopupControl>
          </dxb:BarSplitButtonItem>
          <dxb:BarButtonItem ToolTipService.ShowOnDisabled="True"
                               Command="{Binding DataContext.ShowHiddenAxesCommand, ElementName=Chart}"
                               Content="{loc:Localization ShowHiddenAxes}"
                               ToolTip="{loc:Localization ShowHiddenAxes}" Glyph="{loc:ThemedIcons Key=Footer}"/>
          <dxb:BarItemSeparator/>
          <dxb:BarSplitButtonItem ToolTipService.ShowOnDisabled="True"
                                    Command="{x:Static l1lil:ChartPanel.RegisterOrderCommand}"
                                    DataContext="{Binding ElementName=Chart}" CommandTarget="{Binding ElementName=Ctrl, Mode=OneWay}">
            <dxb:BarItem.SuperTip>
              <dx:SuperTip>
                <dx:SuperTipHeaderItem Content="{loc:Localization RegOrdersByClick}"/>
                <dx:SuperTipItem Content="{loc:Localization BuyCtrlLeftMouse}"/>
                <dx:SuperTipItem Content="{loc:Localization SellCtrlRightMouse}"/>
              </dx:SuperTip>
            </dxb:BarItem.SuperTip>
            <dxb:BarItem.GlyphTemplate>
              <DataTemplate>
                <ToggleButton Margin="-3" Style="{StaticResource {x:Static ToolBar.ToggleButtonStyleKey}}"
                              IsChecked="{Binding Path=OrderCreationMode}">
                  <Image Style="{StaticResource ImgStyle}" Source="{loc:ThemedIcons Key=Mouse}">
                    <dx:WpfSvgPalette.Palette>
                      <li1111lil:ThemeResource ThemeKey="{l11:BarSvgPaletteThemeKey ResourceKey=SvgPaletteInBar}"/>
                    </dx:WpfSvgPalette.Palette>
                  </Image>
                </ToggleButton>
              </DataTemplate>
            </dxb:BarItem.GlyphTemplate>
            <dxb:BarSplitButtonItem.PopupControl>
              <dxb:PopupMenu>
                <dxb:PopupMenu.Items>
                  <dxb:BarButtonItem Content="{loc:Localization Settings}" Glyph="{loc:ThemedIcons Key=Settings}"/>
                </dxb:PopupMenu.Items>
              </dxb:PopupMenu>
            </dxb:BarSplitButtonItem.PopupControl>
          </dxb:BarSplitButtonItem>
          <dxb:BarCheckItem x:Name="QuickOrderPanelButton" ToolTipService.ShowOnDisabled="True"
                              IsChecked="{Binding ElementName=QuickOrderPanel, Path=Visibility, Converter={StaticResource VisToBool}}"
                              Glyph="{loc:ThemedIcons Key=Order}" Content="{loc:Localization ShowQuickOrdersPanel}"
                              ToolTip="{loc:Localization ShowQuickOrdersPanel}"
                              IsEnabled="{Binding IsInteracted, ElementName=Chart}"/>
          <dxb:BarButtonItem Command="{x:Static loc:RoutedCommands.CancelOrders}"
                               ToolTipService.ShowOnDisabled="True" Glyph="{loc:ThemedIcons Key=Remove2}"
                               CommandTarget="{Binding ElementName=Ctrl}" ToolTip="{loc:Localization CancelOrders}"/>
        </dxb:Bar>
      </dxb:BarManager.Bars>
    </dxb:BarManager>
    <l1lil:Chart x:Name="Chart" Grid.Row="1"/>
  </Grid>
</l1lil:ChartPanel>