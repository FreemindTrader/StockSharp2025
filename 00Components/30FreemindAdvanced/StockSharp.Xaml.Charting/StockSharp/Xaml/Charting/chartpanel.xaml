<local:ChartPanel
    x:Name="Ctrl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="clr-namespace:DevExpress.Xpf.Core;assembly=DevExpress.Xpf.Core.v22.1"
    xmlns:dxb="clr-namespace:DevExpress.Xpf.Bars;assembly=DevExpress.Xpf.Core.v22.1"
    xmlns:dxe="clr-namespace:DevExpress.Xpf.Editors.Settings;assembly=DevExpress.Xpf.Core.v22.1"
    xmlns:l11="clr-namespace:DevExpress.Xpf.Bars.Themes;assembly=DevExpress.Xpf.Core.v22.1"
    xmlns:l1i="clr-namespace:DevExpress.Xpf.Utils.Themes;assembly=DevExpress.Xpf.Core.v22.1"
    xmlns:li1111lil="clr-namespace:DevExpress.Xpf.Core.Native;assembly=DevExpress.Xpf.Core.v22.1"
    xmlns:ll1="clr-namespace:Ecng.Xaml.Converters;assembly=StockSharp.Xaml"
    xmlns:lll="clr-namespace:Ecng.Xaml;assembly=StockSharp.Xaml"
    xmlns:loc="clr-namespace:StockSharp.Xaml;assembly=StockSharp.Xaml"
    xmlns:local="clr-namespace:StockSharp.Xaml.Charting"
    xmlns:s="clr-namespace:-"
    dxb:BarNameScope.IsScopeOwner="True">
    <UIElement.CommandBindings>
        <CommandBinding Command="{x:Static local:ChartPanel.RegisterOrderCommand}" />
        <CommandBinding Command="{x:Static local:ChartPanel.ShareCommand}" />
        <CommandBinding Command="{x:Static loc:RoutedCommands.CancelOrders}" />
        <CommandBinding Command="{x:Static local:ChartPanel.PatternCommand}" />
    </UIElement.CommandBindings>
    <FrameworkElement.Resources>
        <Style x:Key="ImgStyle" TargetType="{x:Type Image}">
            <Style.Triggers>
                <DataTrigger Value="False" Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, AncestorLevel=1}, Path=IsEnabled}">
                    <Setter Property="UIElement.Opacity" Value="0.3" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <ll1:EnumBooleanConverter x:Key="EnumBooleanConverter" DefaultValueWhenUnchecked="True" />
        <ll1:VisibilityToBoolConverter x:Key="VisToBool" />
        <local:ChartTimeFrameNameConverter x:Key="TimeFrame2Name" />
    </FrameworkElement.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <loc:QuickOrderPanel
            x:Name="QuickOrderPanel"
            Grid.Row="1"
            Width="400"
            Height="45"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Panel.ZIndex="100"
            Visibility="Collapsed" />
        <dxb:BarManager x:Name="BarManager" Grid.Row="0">
            <dxb:BarManager.Bars>
                <dxb:Bar>
                    <dxb:BarSplitButtonItem
                        ActAsDropDown="True"
                        Glyph="{loc:ThemedIcons Key=Add}"
                        IsEnabled="{Binding IsInteracted, ElementName=Chart}"
                        ToolTip="{loc:Localization AddPanel}"
                        ToolTipService.ShowOnDisabled="True">
                        <dxb:BarSplitButtonItem.PopupControl>
                            <s:dje_zHRCSWK4ZNLJHREKZYGF3XQ6G3FQDVTLXGBGA7V24_ejd DataContext="{Binding DataContext, ElementName=Chart}" />
                        </dxb:BarSplitButtonItem.PopupControl>
                    </dxb:BarSplitButtonItem>
                    <dxb:BarEditItem x:Name="CandleStyles" EditWidth="120">
                        <dxb:BarEditItem.EditSettings>
                            <dxe:ComboBoxEditSettings
                                x:Name="CandleStylesSettings"
                                ApplyItemTemplateToSelectedItem="True"
                                IsTextEditable="False">
                                <dxe:LookUpEditSettingsBase.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="Transparent">
                                            <StackPanel Orientation="Horizontal">
                                                <Image
                                                    Width="16"
                                                    Height="16"
                                                    Source="{lll:ThemedIconBinding Path=Image}" />
                                                <TextBlock
                                                    Margin="5,0,0,0"
                                                    VerticalAlignment="Center"
                                                    Text="{Binding Path=Name}" />
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </dxe:LookUpEditSettingsBase.ItemTemplate>
                            </dxe:ComboBoxEditSettings>
                        </dxb:BarEditItem.EditSettings>
                    </dxb:BarEditItem>
                    <dxb:BarEditItem
                        x:Name="TfSelector"
                        EditWidth="65"
                        IsEnabled="{Binding IsInteracted, ElementName=Chart}">
                        <dxb:BarEditItem.EditSettings>
                            <dxe:ComboBoxEditSettings
                                x:Name="_tfSelectorCb"
                                ApplyItemTemplateToSelectedItem="True"
                                IsTextEditable="False">
                                <dxe:LookUpEditSettingsBase.ItemTemplate>
                                    <DataTemplate>
                                        <Border Margin="5,0" Background="Transparent">
                                            <TextBlock VerticalAlignment="Center" Text="{Binding Path=., Converter={StaticResource TimeFrame2Name}}" />
                                        </Border>
                                    </DataTemplate>
                                </dxe:LookUpEditSettingsBase.ItemTemplate>
                            </dxe:ComboBoxEditSettings>
                        </dxb:BarEditItem.EditSettings>
                    </dxb:BarEditItem>
                    <dxb:BarItemSeparator />
                    <dxb:BarCheckItem
                        Content="{loc:Localization AutoScroll}"
                        Glyph="{loc:ThemedIcons Key=Scroll}"
                        IsChecked="{Binding ElementName=Chart, Path=IsAutoScroll}"
                        ToolTip="{loc:Localization AutoScroll}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization AutoScaling}"
                        Glyph="{loc:ThemedIcons Key=UpDown}"
                        IsChecked="{Binding ElementName=Chart, Path=AutoRangeByAnnotations}"
                        ToolTip="{loc:Localization AutoScaling}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization Legend}"
                        Glyph="{loc:ThemedIcons Key=List}"
                        IsChecked="{Binding ElementName=Chart, Path=ShowLegend}"
                        ToolTip="{loc:Localization Legend}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization OverviewArea}"
                        Glyph="{loc:ThemedIcons Key=Footer}"
                        IsChecked="{Binding ElementName=Chart, Path=ShowOverview}"
                        ToolTip="{loc:Localization OverviewArea}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization ShowCross}"
                        Glyph="{loc:ThemedIcons Key=Crosshair}"
                        IsChecked="{Binding ElementName=Chart, Path=CrossHair}"
                        ToolTip="{loc:Localization ShowCross}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization ShowTooltip}"
                        Glyph="{loc:ThemedIcons Key=Tooltip}"
                        IsChecked="{Binding ElementName=Chart, Path=CrossHairTooltip}"
                        IsEnabled="{Binding ElementName=Chart, Path=CrossHair}"
                        ToolTip="{loc:Localization ShowTooltip}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization ShowValuesOnAxis}"
                        Glyph="{loc:ThemedIcons Key=Ruler}"
                        IsChecked="{Binding ElementName=Chart, Path=CrossHairAxisLabels}"
                        IsEnabled="{Binding ElementName=Chart, Path=CrossHair}"
                        ToolTip="{loc:Localization ShowValuesOnAxis}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarButtonItem
                        Command="{x:Static local:ChartPanel.PatternCommand}"
                        CommandTarget="{Binding ElementName=Ctrl}"
                        Content="{loc:Localization Pattern}"
                        Glyph="{loc:ThemedIcons Key=GanttChart}"
                        ToolTip="{loc:Localization PatternDesc}" />
                    <dxb:BarItemSeparator />
                    <dxb:BarCheckItem
                        Content="{loc:Localization Line2}"
                        Glyph="{loc:ThemedIcons Key=Line}"
                        IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=LineAnnotation}"
                        ToolTip="{loc:Localization Line2}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization Pointer}"
                        Glyph="{loc:ThemedIcons Key=RightArrowLine}"
                        IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=LineArrowAnnotation}"
                        ToolTip="{loc:Localization Pointer}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization VerLine}"
                        IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=VerticalLineAnnotation}"
                        ToolTip="{loc:Localization VerLine}"
                        ToolTipService.ShowOnDisabled="True">
                        <dxb:BarItem.GlyphTemplate>
                            <DataTemplate>
                                <Image Source="{loc:ThemedIcons Key=Line}">
                                    <UIElement.RenderTransform>
                                        <RotateTransform Angle="-45" CenterX="7" CenterY="7" />
                                    </UIElement.RenderTransform>
                                </Image>
                            </DataTemplate>
                        </dxb:BarItem.GlyphTemplate>
                    </dxb:BarCheckItem>
                    <dxb:BarCheckItem
                        Content="{loc:Localization HorLine}"
                        IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=HorizontalLineAnnotation}"
                        ToolTip="{loc:Localization HorLine}"
                        ToolTipService.ShowOnDisabled="True">
                        <dxb:BarItem.GlyphTemplate>
                            <DataTemplate>
                                <Image Source="{loc:ThemedIcons Key=Line}">
                                    <UIElement.RenderTransform>
                                        <RotateTransform Angle="45" CenterX="7" CenterY="7" />
                                    </UIElement.RenderTransform>
                                </Image>
                            </DataTemplate>
                        </dxb:BarItem.GlyphTemplate>
                    </dxb:BarCheckItem>
                    <dxb:BarCheckItem
                        Content="{loc:Localization Area}"
                        Glyph="{loc:ThemedIcons Key=Rectangle}"
                        IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=BoxAnnotation}"
                        ToolTip="{loc:Localization Area}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization Text}"
                        Glyph="{loc:ThemedIcons Key=Font}"
                        IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=TextAnnotation}"
                        ToolTip="{loc:Localization Text}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization Ruler}"
                        Glyph="{loc:ThemedIcons Key=Ruler2}"
                        IsChecked="{Binding ElementName=Chart, Path=AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=RulerAnnotation}"
                        ToolTip="{loc:Localization Ruler}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarCheckItem
                        Content="{loc:Localization ShowFPS}"
                        Glyph="{loc:ThemedIcons Key=Speedometer}"
                        IsChecked="{Binding ElementName=Chart, Path=ShowPerfStats}"
                        ToolTip="{loc:Localization ShowFPS}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarItemSeparator />
                    <dxb:BarButtonItem
                        Content="{loc:Localization SaveDataFromChart}"
                        Glyph="{loc:ThemedIcons Key=Save}"
                        ToolTip="{loc:Localization SaveDataFromChart}" />
                    <dxb:BarSplitButtonItem
                        Command="{x:Static local:ChartPanel.ShareCommand}"
                        CommandTarget="{Binding ElementName=Ctrl}"
                        Content="{loc:Localization ShareImage}"
                        Glyph="{loc:ThemedIcons Key=Share}"
                        ToolTip="{loc:Localization ShareImage}">
                        <dxb:BarSplitButtonItem.PopupControl>
                            <dxb:PopupMenu>
                                <dxb:PopupMenu.Items>
                                    <dxb:BarButtonItem Content="{loc:Localization Settings}" Glyph="{loc:ThemedIcons Key=Settings}" />
                                </dxb:PopupMenu.Items>
                            </dxb:PopupMenu>
                        </dxb:BarSplitButtonItem.PopupControl>
                    </dxb:BarSplitButtonItem>
                    <dxb:BarButtonItem
                        Command="{Binding DataContext.ShowHiddenAxesCommand, ElementName=Chart}"
                        Content="{loc:Localization ShowHiddenAxes}"
                        Glyph="{loc:ThemedIcons Key=Footer}"
                        ToolTip="{loc:Localization ShowHiddenAxes}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarItemSeparator />
                    <dxb:BarSplitButtonItem
                        Command="{x:Static local:ChartPanel.RegisterOrderCommand}"
                        CommandTarget="{Binding ElementName=Ctrl, Mode=OneWay}"
                        DataContext="{Binding ElementName=Chart}"
                        ToolTipService.ShowOnDisabled="True">
                        <dxb:BarItem.SuperTip>
                            <dx:SuperTip>
                                <dx:SuperTipHeaderItem Content="{loc:Localization RegOrdersByClick}" />
                                <dx:SuperTipItem Content="{loc:Localization BuyCtrlLeftMouse}" />
                                <dx:SuperTipItem Content="{loc:Localization SellCtrlRightMouse}" />
                            </dx:SuperTip>
                        </dxb:BarItem.SuperTip>
                        <dxb:BarItem.GlyphTemplate>
                            <DataTemplate>
                                <ToggleButton
                                    Margin="-3"
                                    IsChecked="{Binding Path=OrderCreationMode}"
                                    Style="{StaticResource {x:Static ToolBar.ToggleButtonStyleKey}}">
                                    <Image Source="{loc:ThemedIcons Key=Mouse}" Style="{StaticResource ImgStyle}">
                                        <dx:WpfSvgPalette.Palette>
                                            <li1111lil:ThemeResource ThemeKey="{l11:BarSvgPaletteThemeKey ResourceKey=SvgPaletteInBar}" />
                                        </dx:WpfSvgPalette.Palette>
                                    </Image>
                                </ToggleButton>
                            </DataTemplate>
                        </dxb:BarItem.GlyphTemplate>
                        <dxb:BarSplitButtonItem.PopupControl>
                            <dxb:PopupMenu>
                                <dxb:PopupMenu.Items>
                                    <dxb:BarButtonItem Content="{loc:Localization Settings}" Glyph="{loc:ThemedIcons Key=Settings}" />
                                </dxb:PopupMenu.Items>
                            </dxb:PopupMenu>
                        </dxb:BarSplitButtonItem.PopupControl>
                    </dxb:BarSplitButtonItem>
                    <dxb:BarCheckItem
                        x:Name="QuickOrderPanelButton"
                        Content="{loc:Localization ShowQuickOrdersPanel}"
                        Glyph="{loc:ThemedIcons Key=Order}"
                        IsChecked="{Binding ElementName=QuickOrderPanel, Path=Visibility, Converter={StaticResource VisToBool}}"
                        IsEnabled="{Binding IsInteracted, ElementName=Chart}"
                        ToolTip="{loc:Localization ShowQuickOrdersPanel}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxb:BarButtonItem
                        Command="{x:Static loc:RoutedCommands.CancelOrders}"
                        CommandTarget="{Binding ElementName=Ctrl}"
                        Glyph="{loc:ThemedIcons Key=Remove2}"
                        ToolTip="{loc:Localization CancelOrders}"
                        ToolTipService.ShowOnDisabled="True" />
                </dxb:Bar>
            </dxb:BarManager.Bars>
        </dxb:BarManager>
        <local:Chart x:Name="Chart" Grid.Row="1" />
    </Grid>
</local:ChartPanel>