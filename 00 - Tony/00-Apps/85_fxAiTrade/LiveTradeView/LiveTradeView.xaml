<UserControl
    x:Class="FreemindAITrade.View.LiveTradeView"
    x:Name="Ctrl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:cnvt="clr-namespace:Ecng.Xaml.Converters;assembly=StockSharp.Xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxBars="http://schemas.devexpress.com/winfx/2008/xaml/bars"
    xmlns:dxes="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
    xmlns:dxprg="http://schemas.devexpress.com/winfx/2008/xaml/propertygrid"
    xmlns:loc="clr-namespace:StockSharp.Localization;assembly=StockSharp.Localization"
    xmlns:local="clr-namespace:FreemindAITrade.View"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ssXaml="clr-namespace:StockSharp.Xaml;assembly=StockSharp.Xaml"
    xmlns:sxChart="clr-namespace:fx.Charting;assembly=fx.Charting"
    xmlns:sxpg="clr-namespace:StockSharp.Xaml.PropertyGrid;assembly=StockSharp.Xaml"
    xmlns:VM="clr-namespace:FreemindAITrade.ViewModels"
    mc:Ignorable="d"
    d:DesignHeight="450"
    d:DesignWidth="800"
    dxmvvm:ViewModelExtensions.Parameter="{Binding DataContext, ElementName=Chart}">
    <FrameworkElement.Resources>
        <Style x:Key="ImgStyle" TargetType="{x:Type Image}">
            <Style.Triggers>
                <DataTrigger Value="False" Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, AncestorLevel=1}, Path=IsEnabled}">
                    <Setter Property="UIElement.Opacity" Value="0.3" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <cnvt:EnumBooleanConverter x:Key="EnumBooleanConverter" DefaultValueWhenUnchecked="true" />
        <cnvt:VisibilityToBoolConverter x:Key="VisToBool" />
    </FrameworkElement.Resources>
    <dxmvvm:Interaction.Behaviors>
        <dxmvvm:EventToCommand Command="{Binding SetupChartCommand}" Event="Loaded" />
        <dx:DXMessageBoxService />
    </dxmvvm:Interaction.Behaviors>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>
        <ssXaml:QuickOrderPanel
            x:Name="QuickOrderPanel"
            Grid.Column="1"
            Width="400"
            Height="45"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Panel.ZIndex="100"
            RegisterOrder="QuickOrderPanel_RegisterOrder"
            Security="{Binding ElementName=Ctrl, Path=DataContext.QuickOrderSecurity }"
            SettingsChanged="QuickOrderPanel_SettingsChanged"
            Visibility="Collapsed" />
        <dxBars:BarManager
            x:Name="BarManager"
            Grid.Column="0"
            AllowGlyphTheming="true">
            <dxBars:BarManager.Bars>
                <dxBars:Bar>
                    <dxBars:Bar.DockInfo>
                        <dxBars:BarDockInfo ContainerType="Left" />
                    </dxBars:Bar.DockInfo>
                    <dxBars:BarButtonItem
                        Command="{Binding AddAreaCommand}"
                        CommandTarget="{Binding ElementName=Ctrl, Mode=OneWay}"
                        Glyph="{dx:DXImage SvgImages/Dashboards/AddQuery.svg}"
                        ToolTip="{x:Static loc:LocalizedStrings.XamlStr143}"
                        ToolTipService.ShowOnDisabled="true" />

                    <dxBars:BarItemSeparator />
                    <dxBars:BarCheckItem
                        Command="{Binding OnSettingClickedCommand}"
                        Glyph="{dx:DXImage SvgImages/Arrows/Last.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.IsAutoScroll}"
                        ToolTip="{x:Static loc:LocalizedStrings.XamlStr17}"
                        ToolTipService.ShowOnDisabled="true" />

                    <dxBars:BarCheckItem
                        Command="{Binding OnSettingClickedCommand}"
                        Glyph="{dx:DXImage SvgImages/Dashboards/GridColumnFixedWidth.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AutoRangeByAnnotations}"
                        ToolTip="{x:Static loc:LocalizedStrings.XamlStr14}"
                        ToolTipService.ShowOnDisabled="true" />

                    <dxBars:BarCheckItem
                        Command="{Binding OnSettingClickedCommand}"
                        Glyph="{dx:DXImage SvgImages/Dashboards/AlignmentTopLeft.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.ShowLegend}"
                        ToolTip="{x:Static loc:LocalizedStrings.Str1964}"
                        ToolTipService.ShowOnDisabled="true" />

                    <dxBars:BarCheckItem
                        Command="{Binding OnSettingClickedCommand}"
                        Glyph="{dx:DXImage SvgImages/Reports/GroupFooter.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.ShowOverview}"
                        ToolTip="{x:Static loc:LocalizedStrings.OverviewArea}"
                        ToolTipService.ShowOnDisabled="true" />

                    <dxBars:BarCheckItem
                        Command="{Binding OnSettingClickedCommand}"
                        Glyph="{dx:DXImage SvgImages/RichEdit/BordersInside.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.CrossHair}"
                        KeyGesture="Ctrl+H"
                        ToolTip="{x:Static loc:LocalizedStrings.ShowCross}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Command="{Binding OnSettingClickedCommand}"
                        Glyph="{dx:DXImage SvgImages/Icon Builder/Actions_Comment.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.CrossHairTooltip}"
                        IsEnabled="{Binding ElementName=Chart, Path=DataContext.CrossHair}"
                        ToolTip="{x:Static loc:LocalizedStrings.ShowTooltip}"
                        ToolTipService.ShowOnDisabled="true" />

                    <dxBars:BarCheckItem
                        Command="{Binding OnSettingClickedCommand}"
                        Glyph="{dx:DXImage SvgImages/Spreadsheet/ChartAxesGroup.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.CrossHairAxisLabels}"
                        IsEnabled="{Binding ElementName=Chart, Path=DataContext.CrossHair}"
                        ToolTip="{x:Static loc:LocalizedStrings.XamlStr487}"
                        ToolTipService.ShowOnDisabled="true" />

                    <dxBars:BarItemSeparator />
                    <dxBars:BarCheckItem
                        Glyph="{dx:SvgImageSource Uri=../SvgImages/WaveAnalytics.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=fxElliotWaveAnnotation}"
                        ToolTip="{x:Static loc:LocalizedStrings.ElliotWave}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Glyph="{dx:SvgImageSource Uri=../SvgImages/PivotPoints.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=fxFibonacciRetracementAnnotation}"
                        ToolTip="{x:Static loc:LocalizedStrings.FibRetracement}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Glyph="{dx:SvgImageSource Uri=../SvgImages/HighLow3.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=fxFibonacciExtensionAnnotation}"
                        ToolTip="{x:Static loc:LocalizedStrings.FibExpansion}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Glyph="{dx:DXImage SvgImages/Icon Builder/Business_LinearChart.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=LineAnnotation}"
                        ToolTip="{x:Static loc:LocalizedStrings.Str1898}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Glyph="{dx:DXImage SvgImages/Dashboards/TreemapBottomLeftTopRightDirection.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=LineArrowAnnotation}"
                        ToolTip="{x:Static loc:LocalizedStrings.Str1899}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Glyph="{dx:DXImage SvgImages/RichEdit/BorderInsideVertical.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=VerticalLineAnnotation}"
                        ToolTip="{x:Static loc:LocalizedStrings.Str1902}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Glyph="{dx:DXImage SvgImages/RichEdit/BorderInsideHorizontal.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=HorizontalLineAnnotation}"
                        ToolTip="{x:Static loc:LocalizedStrings.Str1901}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Glyph="{dx:DXImage SvgImages/DiagramIcons/Figures/figures1.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=BoxAnnotation}"
                        ToolTip="{x:Static loc:LocalizedStrings.Area}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Glyph="{dx:DXImage SvgImages/Dashboards/EditNames.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=TextAnnotation}"
                        ToolTip="{x:Static loc:LocalizedStrings.Str217}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Glyph="{ssXaml:ThemedIcons Key=Ruler2}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.AnnotationType, Converter={StaticResource EnumBooleanConverter}, ConverterParameter=RulerAnnotation}"
                        ToolTip="{x:Static loc:LocalizedStrings.Ruler}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarCheckItem
                        Glyph="{dx:DXImage SvgImages/Dashboards/Gauges.svg}"
                        IsChecked="{Binding ElementName=Chart, Path=DataContext.ShowPerfStats}"
                        ToolTip="{x:Static loc:LocalizedStrings.ShowFPS}"
                        ToolTipService.ShowOnDisabled="true" />
                    <dxBars:BarItemSeparator />
                    <dxBars:BarSplitButtonItem
                        Command="{Binding RegisterOrderCommand}"
                        CommandTarget="{Binding ElementName=Ctrl, Mode=OneWay}"
                        DataContext="{Binding ElementName=Chart}"
                        ToolTipService.ShowOnDisabled="True">
                        <dxBars:BarItem.SuperTip>
                            <dx:SuperTip>
                                <dx:SuperTipHeaderItem Content="{x:Static loc:LocalizedStrings.XamlStr94}" />
                                <dx:SuperTipItem Content="{x:Static loc:LocalizedStrings.XamlStr4}" />
                                <dx:SuperTipItem Content="{x:Static loc:LocalizedStrings.XamlStr8}" />
                            </dx:SuperTip>
                        </dxBars:BarItem.SuperTip>
                        <dxBars:BarItem.GlyphTemplate>
                            <DataTemplate>
                                <ToggleButton
                                    Margin="-3"
                                    IsChecked="{Binding Path=DataContext.OrderCreationMode}"
                                    Style="{StaticResource {x:Static ToolBar.ToggleButtonStyleKey}}">
                                    <Image Source="{ssXaml:ThemedIcons Key=Mouse}" Style="{StaticResource ImgStyle}">
                                        <!--<dx:WpfSvgPalette.Palette>
                                            <core:ThemeResource ThemeKey="{theme:BarSvgPaletteThemeKey ResourceKey=SvgPaletteInBar}" />
                                        </dx:WpfSvgPalette.Palette>-->
                                    </Image>
                                </ToggleButton>
                            </DataTemplate>
                        </dxBars:BarItem.GlyphTemplate>
                        <dxBars:BarSplitButtonItem.PopupControl>
                            <dxBars:PopupControlContainer>
                                <sxpg:PropertyGridEx
                                    x:Name="OrderSettingsPropertyGrid"
                                    Width="270"
                                    MinHeight="140"
                                    SelectedObject="{Binding ElementName=Ctrl, Path=DataContext.OrderSettings}" />
                            </dxBars:PopupControlContainer>
                        </dxBars:BarSplitButtonItem.PopupControl>
                    </dxBars:BarSplitButtonItem>
                    <dxBars:BarCheckItem
                        x:Name="QuickOrderPanelButton"
                        Content="{x:Static loc:LocalizedStrings.ShowQuickOrdersPanel}"
                        Glyph="{ssXaml:ThemedIcons Key=Order}"
                        IsChecked="{Binding ElementName=QuickOrderPanel, Path=Visibility, Converter={StaticResource VisToBool}}"
                        ToolTip="{x:Static loc:LocalizedStrings.ShowQuickOrdersPanel}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxBars:BarButtonItem
                        Command="{x:Static ssXaml:RoutedCommands.CancelOrders}"
                        CommandTarget="{Binding ElementName=Ctrl}"
                        Glyph="{ssXaml:ThemedIcons Key=Remove2}"
                        ToolTip="{x:Static loc:LocalizedStrings.Str858}"
                        ToolTipService.ShowOnDisabled="True" />
                    <dxBars:BarButtonItem Glyph="{dx:DXImage SvgImages/Outlook Inspired/SaveAs.svg}" ToolTip="{x:Static loc:LocalizedStrings.XamlStr691}">
                        <dxmvvm:Interaction.Behaviors>
                            <dxmvvm:EventToCommand Command="{Binding SaveAsCommand}" EventName="ItemClick" />
                        </dxmvvm:Interaction.Behaviors>
                    </dxBars:BarButtonItem>
                    <dxBars:BarSplitButtonItem
                        x:Name="ShareButton"
                        Glyph="{dx:DXImage SvgImages/Icon Builder/Actions_Image.svg}"
                        IsEnabled="false"
                        ToolTip="{x:Static loc:LocalizedStrings.ShareImage}">
                        <dxBars:BarSplitButtonItem.PopupControl>
                            <dxBars:PopupControlContainer>
                                <sxpg:PropertyGridEx
                                    x:Name="ShareSettingsPropertyGrid"
                                    Width="270"
                                    MinHeight="140"
                                    dxprg:PropertyGridControl.ShowCategories="Hidden"
                                    dxprg:PropertyGridControl.ShowDescriptionIn="ToolTip"
                                    dxprg:PropertyGridControl.ShowMenuButtonInRows="false"
                                    dxprg:PropertyGridControl.ShowSearchBox="false"
                                    dxprg:PropertyGridControl.ShowToolPanel="false" />
                            </dxBars:PopupControlContainer>
                        </dxBars:BarSplitButtonItem.PopupControl>
                    </dxBars:BarSplitButtonItem>
                </dxBars:Bar>
            </dxBars:BarManager.Bars>
        </dxBars:BarManager>
        <sxChart:ChartExView x:Name="Chart" Grid.Column="1" />
    </Grid>

</UserControl>